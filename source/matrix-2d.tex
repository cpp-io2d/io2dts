%!TEX root = io2d.tex
\rSec0 [\matrixtwod] {Class \tcode{matrix_2d}}

\rSec1 [\matrixtwod.intro] {\tcode{matrix_2d} Description}

\pnum
\indexlibrary{\idxcode{matrix_2d}}
The \tcode{matrix_2d} class represents a two-dimensional, three row by three column matrix. Its purpose is to perform affine transformations.

\pnum
Mathematically, regardless of the operations performed on a \tcode{matrix_2d}, the third column will always have the column vector value of $[0.0, 0.0, 1.0]$. As such, it is not included in the observable data of the matrix.

\pnum
The performance of any mathematical operation upon a \tcode{matrix_2d} shall be carried out as if the omitted third column data members were present with the values prescribed in the previous paragraph.

\pnum
If the third column's data members were observable, they would be:

\begin{itemize}
\item M02, a \tcode{double} which would follow \tcode{m01} in the same row and would be assigned a value of \tcode{0.0}.

\item M12, a \tcode{double} which would follow \tcode{m11} in the same row and would be assigned a value of \tcode{0.0}.

\item M22, a \tcode{double} which would follow \tcode{m21} in the same row and would be assigned a value of \tcode{1.0}.
\end{itemize}

\pnum
The layout of the matrix is: \\
$
~[~[~M00~M01~M02~]~] \\
~[~[~M10~M11~M12~]~] \\
~[~[~M20~M21~M22~]~]$

\pnum
The values M00, M01, M10, M11, M20, M21 shall each be of type \tcode{double}.

\rSec1 [\matrixtwod.synopsis] {\tcode{matrix_2d} synopsis}

\begin{codeblock}
namespace std { namespace experimental { namespace io2d { inline namespace v1 {
  class matrix_2d {
  public:
    // \ref{\matrixtwod.cons}, construct/copy/move/destroy:
    constexpr matrix_2d() noexcept;
    constexpr matrix_2d(double v00, double v01, double v10, double v11,
      double v20, double v21) noexcept;
    constexpr matrix_2d(const matrix_2d&) noexcept;
    constexpr matrix_2d& operator=(const matrix_2d&) noexcept;
    matrix_2d(matrix_2d&&) noexcept;
    matrix_2d& operator=(matrix_2d&&) noexcept;
    
    // \ref{\matrixtwod.staticfactories}, static factory functions:
    constexpr static matrix_2d init_identity() noexcept;
    constexpr static matrix_2d init_translate(const vector_2d& value) noexcept;
    constexpr static matrix_2d init_scale(const vector_2d& value) noexcept;
    static matrix_2d init_rotate(double radians) noexcept;
    constexpr static matrix_2d init_shear_x(double factor) noexcept;
    constexpr static matrix_2d init_shear_y(double factor) noexcept;
    
    // \ref{\matrixtwod.modifiers}, modifiers:
    void m00(double v) noexcept;
    void m01(double v) noexcept;
    void m10(double v) noexcept;
    void m11(double v) noexcept;
    void m20(double v) noexcept;
    void m21(double v) noexcept;
    matrix_2d& translate(const vector_2d& v) noexcept;
    matrix_2d& scale(const vector_2d& v) noexcept;
    matrix_2d& rotate(double radians) noexcept;
    matrix_2d& shear_x(double factor) noexcept;
    matrix_2d& shear_y(double factor) noexcept;
    matrix_2d& invert();
    
    // \ref{\matrixtwod.observers}, observers:
    constexpr double m00() const noexcept;
    constexpr double m01() const noexcept;
    constexpr double m10() const noexcept;
    constexpr double m11() const noexcept;
    constexpr double m20() const noexcept;
    constexpr double m21() const noexcept;
    bool is_finite() const noexcept;
    constexpr bool is_invertible() const noexcept;
    constexpr double determinant() const;
    constexpr vector_2d transform_point(const vector_2d& pt) const noexcept;
    
    // \ref{\matrixtwod.member.ops}, matrix_2d member operators:
    matrix_2d& operator*=(const matrix_2d& rhs) noexcept;
  };
    
  // \ref{\matrixtwod.ops}, matrix_2d non-member operators:
  constexpr matrix_2d operator*(const matrix_2d& lhs, const matrix_2d& rhs)
    noexcept;
  constexpr bool operator==(const matrix_2d& lhs, const matrix_2d& rhs)
    noexcept;
  constexpr bool operator!=(const matrix_2d& lhs, const matrix_2d& rhs)
    noexcept;
} } } }
\end{codeblock}

\rSec1 [\matrixtwod.cons] {\tcode{matrix_2d} constructors and assignment operators}

\indexlibrary{\idxcode{matrix_2d}!constructor}
\begin{itemdecl}
constexpr matrix_2d() noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
Constructs an object of type \tcode{matrix_2d}.

\pnum
The M00 value shall be set to \tcode{1.0}.

\pnum
The M01 value shall be set to \tcode{0.0}.

\pnum
The M10 value shall be set to \tcode{0.0}.

\pnum
The M11 value shall be set to \tcode{1.0}.

\pnum
The M20 value shall be set to \tcode{0.0}.

\pnum
The M21 value shall be set to \tcode{0.0}.

\pnum
\realnote
The resulting matrix is the identity matrix, which can also be obtained from \tcode{matrix_2d::init_identity()}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!constructor}
\begin{itemdecl}
constexpr matrix_2d(double v00, double v01, double v10, double v11,
  double v20, double v21) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
Constructs an object of type \tcode{matrix_2d}.

\pnum
The M00 value shall be set to the value of \tcode{v00}.

\pnum
The M01 value shall be set to the value of \tcode{v01}.

\pnum
The M10 value shall be set to the value of \tcode{v10}.

\pnum
The M11 value shall be set to the value of \tcode{v11}.

\pnum
The M20 value shall be set to the value of \tcode{v20}.

\pnum
The M21 value shall be set to the value of \tcode{v21}.
\end{itemdescr}

\rSec1 [\matrixtwod.staticfactories] {\tcode{matrix_2d} static factory 
functions}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{init_identity}}
\indexlibrary{\idxcode{init_identity}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr static matrix_2d init_identity() noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix(1.0, 0.0, 0.0, 1.0, 0.0, 0.0)}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{init_translate}}
\indexlibrary{\idxcode{init_translate}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr static matrix_2d init_translate(const vector_2d& value) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix(1.0, 0.0, 0.0, 1.0, value.x(), value.y())}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{init_scale}}
\indexlibrary{\idxcode{init_scale}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr static matrix_2d init_scale(const vector_2d& value) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix(value.x(), 0.0, 0.0, value.y(), 0.0, 0.0)}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{init_rotate}}
\indexlibrary{\idxcode{init_rotate}!\idxcode{matrix_2d}}
\begin{itemdecl}
static matrix_2d init_rotate(double radians) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix(cos(radians), sin(radians), -sin(radians), cos(radians), 
0.0, 0.0)}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{init_shear_x}}
\indexlibrary{\idxcode{init_shear_y}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr static matrix_2d init_shear_x(double factor) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix(1.0, 0.0, factor, 1.0, 0.0, 0.0)}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{init_shear_y}}
\indexlibrary{\idxcode{init_shear_y}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr static matrix_2d init_shear_y(double factor) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix\{ 1.0, factor, 0.0, 1.0, 0.0, 0.0 \}}
\end{itemdescr}

\rSec1 [\matrixtwod.modifiers] {\tcode{matrix_2d} modifiers}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m00}}
\indexlibrary{\idxcode{m00}!\idxcode{matrix_2d}}
\begin{itemdecl}
void m00(double val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The M00 value shall be set to the value of \tcode{val}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m01}}
\indexlibrary{\idxcode{m01}!\idxcode{matrix_2d}}
\begin{itemdecl}
void m01(double val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The M01 value shall be set to the value of \tcode{val}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m10}}
\indexlibrary{\idxcode{m10}!\idxcode{matrix_2d}}
\begin{itemdecl}
void m10(double val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The M10 value shall be set to the value of \tcode{val}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m11}}
\indexlibrary{\idxcode{m11}!\idxcode{matrix_2d}}
\begin{itemdecl}
void m11(double val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The M11 value shall be set to the value of \tcode{val}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m20}}
\indexlibrary{\idxcode{m20}!\idxcode{matrix_2d}}
\begin{itemdecl}
void m20(double val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The M20 value shall be set to the value of \tcode{val}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m21}}
\indexlibrary{\idxcode{m21}!\idxcode{matrix_2d}}
\begin{itemdecl}
void m21(double value) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The M21 value shall be set to the value of \tcode{val}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{translate}}
\indexlibrary{\idxcode{translate}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& translate(const vector_2d& val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{*this = init_translate(value) * (*this)}.

\pnum
\returns
\tcode{*this}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{scale}}
\indexlibrary{\idxcode{scale}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& scale(const vector_2d& val) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{*this = init_scale(value) * (*this)}.

\pnum
\returns
\tcode{*this}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{rotate}}
\indexlibrary{\idxcode{rotate}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& rotate(double radians) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{*this = init_rotate(radians) * (*this)}.

\pnum
\returns
\tcode{*this}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{shear_x}}
\indexlibrary{\idxcode{shear_x}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& shear_x(double factor) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{*this = init_shear_x(factor) * (*this)}.

\pnum
\returns
\tcode{*this}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{shear_y}}
\indexlibrary{\idxcode{shear_y}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& shear_y(double factor) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{*this = init_shear_y(factor) * (*this)}.

\pnum
\returns
\tcode{*this}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{invert}}
\indexlibrary{\idxcode{invert}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& invert() noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\preconditions
\tcode{*this.isfinite() == true}.

\pnum
\effects
\begin{codeblock}
const auto det = *this.m00() * *this.m11() - *this.m01() * *this.m10*();
const auto inverseDet = 1.0 / det;

const auto cM02 = 0.0;
const auto cM12 = 0.0;
const auto cM22 = 1.0;

const auto adjugateM00 =   *this.m11() * cM22 - cM12 * *this.m21();
const auto adjugateM01 = -(*this.m01() * cM22 - cM02 * *this.m21());
const auto adjugateM10 = -(*this.m10() * cM22 - cM12 * *this.m20());
const auto adjugateM11 =   *this.m00() * cM22 - cM02 * *this.m20();
const auto adjugateM20 =   *this.m10() * *this.m21() - *this.m11() * 
  *this.m20();
const auto adjugateM21 = -(*this.m00() * *this.m21() - *this.m01() * 
  *this.m20());

*this.m00(inverseDet * adjugateM00);
*this.m01(inverseDet * adjugateM01);
*this.m10(inverseDet * adjugateM10);
*this.m11(inverseDet * adjugateM11);
*this.m20(inverseDet * adjugateM20);
*this.m21(inverseDet * adjugateM21);
\end{codeblock}

\pnum
\returns
\tcode{*this}.
\end{itemdescr}

\rSec1 [\matrixtwod.observers] {\tcode{matrix_2d} observers}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m00}}
\indexlibrary{\idxcode{m00}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double m00() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
The M00 value.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m01}}
\indexlibrary{\idxcode{m01}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double m01() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
The M01 value.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m10}}
\indexlibrary{\idxcode{m10}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double m10() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
The M10 value.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m11}}
\indexlibrary{\idxcode{m11}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double m11() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
The M11 value.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m20}}
\indexlibrary{\idxcode{m20}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double m20() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
The M20 value.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{m21}}
\indexlibrary{\idxcode{m21}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double m21() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
The M21 value.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{is_finite}}
\indexlibrary{\idxcode{is_finite}!\idxcode{matrix_2d}}
\begin{itemdecl}
bool is_finite const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{true} if all of the following are true:
\begin{itemize}
\item \tcode{isfinite(*this.m00())}
\item \tcode{isfinite(*this.m01())}
\item \tcode{isfinite(*this.m10())}
\item \tcode{isfinite(*this.m11())}
\item \tcode{isfinite(*this.m20())}
\item \tcode{isfinite(*this.m21())}
\end{itemize}

\pnum
Otherwise returns \tcode{false}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{is_invertible}}
\indexlibrary{\idxcode{is_invertible}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr bool is_invertible() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\preconditions
\tcode{*this.is_finite() == true}.

\pnum
\returns
\tcode{()*this.m00() * *this.m11() - *this.m01() * *this.m10()) != 0.0}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{determinant}}
\indexlibrary{\idxcode{determinant}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr double determinant() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\preconditions
\tcode{*this.is_finite() == true}.

\pnum
\returns
\tcode{*this.m00() * *this.m11() - *this.m01() * *this.m10()}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{transform_point}}
\indexlibrary{\idxcode{transform_point}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr vector_2d transform_point(const vector_2d& pt) const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{vector_2d((m00() * pt.x() + m10() * pt.y()) + m20(), (m01() * pt.x() + m11() * pt.y()) + m21())}.
\end{itemdescr}

\rSec1 [\matrixtwod.member.ops] {\tcode{matrix_2d} member operators}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{operator*=}}
\indexlibrary{\idxcode{operator*=}!\idxcode{matrix_2d}}
\begin{itemdecl}
matrix_2d& operator*=(const matrix_2d& rhs) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{*this = *this * rhs}

\pnum
\returns
\tcode{*this}
\end{itemdescr}

\rSec1 [\matrixtwod.ops] {\tcode{matrix_2d} non-member operators}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{operator*}}
\indexlibrary{\idxcode{operator*}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr matrix_2d operator*(const matrix_2d& lhs, const matrix_2d& rhs)
  noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{matrix_2d\{\\
lhs.m00() * rhs.m00() + lhs.m01() * rhs.m10(),\\
lhs.m00() * rhs.m01() + lhs.m01() * rhs.m11(),\\
lhs.m10() * rhs.m00() + lhs.m11() * rhs.m10(),\\
lhs.m10() * rhs.m01() + lhs.m11() * rhs.m11(),\\
lhs.m20() * rhs.m00() + lhs.m21() * rhs.m10() + lhs.m20(),\\
lhs.m20() * rhs.m01() + lhs.m21() * rhs.m11() + lhs.m21()\\
\}}
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{operator==}}
\indexlibrary{\idxcode{operator==}!\idxcode{matrix_2d}}
\begin{itemdecl}
constexpr bool operator==(const matrix_2d& lhs, const matrix_2d& rhs) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns \tcode{lhs.m00() == rhs.m00() \&\& lhs.m01() == rhs.m01() \&\& 
lhs.m10() == rhs.m10() \&\& lhs.m11() == rhs.m11() \&\&
lhs.m20() == rhs.m20() \&\& lhs.m21() == rhs.m21()}.
\end{itemdescr}

\indexlibrary{\idxcode{matrix_2d}!\idxcode{operator!=}}
\indexlibrary{\idxcode{operator!=}!\idxcode{matrix_2d}}%
\begin{itemdecl}
constexpr bool operator!=(const matrix_2d& lhs, const matrix_2d& rhs) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{!(lhs == rhs)}.
\end{itemdescr}
