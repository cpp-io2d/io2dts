%!TEX root = io2d.tex

\rSec0 [paths] {Paths}

\pnum
Paths define geometric objects which can be stroked (Table~\ref{tab:surface.rendering.operations}), filled, masked, and used to define or modify a Clip Area (Table~\ref{tab:surface.state.listing}).

\pnum
Paths are created using a \tcode{path_builder} object, which stores a path group. 

\pnum
Paths provide vector graphics functionality. As such they are particularly useful in situations where an application is intended to run on a variety of platforms whose output devices (\ref{displaysurface.intro}) span a large gamut of sizes, both in terms of measurement units and in terms of a horizontal and vertical pixel count, in that order. For example, a pixel count expressed as 1280x720 means that there are 1280 horizontal pixels per row of pixels and 720 vertical pixels per column of pixels for a total of 921600 pixels.
%
%\pnum
%For output devices, the measurement size of a pixel is determined by the physical size of the output device. Many output devices represent pixels as having the same horizontal and vertical measurement sizes. As such, when they display a rendered image which does not have the same horizontal to vertical pixel ratio as the output device, it 

\pnum
A path may contain degenerate path segments because of special rules, e.g. the \tcode{line_cap} state of a \tcode{surface} object when they are rendered, which are set forth below.

\pnum
A \tcode{path_group} object is an immutable resource wrapper containing a path group (\ref{pathgroup}). A \tcode{path_group} object is created from a \tcode{path_builder} object. It can also be default constructed, in which case the \tcode{path_group} object contains no paths.

\rSec1 [paths.processing] {Processing paths}

\pnum
This section is normative.

\pnum
It describes how to convert a properly formed path group into a \term{processed path group}. The steps required to create a processed path group require the existence of certain state data:

\begin{libiotwodreqtab3}
{path group processing state data}
{tab:paths.processing.statedata}
 \\ \topline
 \lhdr{Data}
 & \chdr{Type}
 & \rhdr{Initial Value}
 \\ \capsep
 \endfirsthead
 \continuedcaption\\
 \hline
 \lhdr{Data}
 & \chdr{Type}
 & \rhdr{Initial Value}
 \\ \capsep
 \endhead
 Transformation Matrix
 & \tcode{matrix_2d}
 & \tcode{matrix_2d::init_identity()}.
 \\
 Origin
 & \tcode{vector_2d}
 & \tcode{vector_2d\{ \}}.
 \\
 Current Point
 & \tcode{optional<vector_2d>}
 & \tcode{optional<vector_2d>\{ \}}.
 \\
\end{libiotwodreqtab3}

\pnum
Certain path instructions and path segments will modify this state data. The state data is used to ensure that the coordinates of all points in the path group's paths are properly transformed to their intended coordinates based on the effects of those path instructions and path segments.

\pnum
\enternote
The coordinates of a path group are in whatever units the user desires. Path instructions such as \tcode{path_data::change_matrix} and \tcode{path_data::change_origin} affect the interpretation of instructions and segments that follow them within the path group. The coordinates of points within the processed path group are further transformed by the a \tcode{surface}-derived object's Transformation Matrix (\ref{surface.state}) when the processed path group is used by any of the object's member functions.
\exitnote

\pnum
The source code below demonstrates how to properly convert a path group into a processed path group.

\pnum
The \tcode{process_path_data} function template transforms the path group contained in a \tcode{path_builder} class template object into a processed path group which is returned as a \tcode{vector<path_data::path_data_types>} object. The processed path group only contains \tcode{path_data::abs_move}, \tcode{path_data::abs_line}, \tcode{path_data::abs_cubic_curve}, and \tcode{path_data::close_path} path items.

\input{path-process-code}

%\rSec1 [paths.strokerules] {Stroking paths}
%
%\pnum
%The following rules shall apply when a Stroking operation (\ref{surface.stroking}) is carried out on a path.
%
%\begin{enumerate}
%\item If the path only contains a degenerate path segment, then if the \tcode{line_cap} value is
%\end{enumerate}
%
%\begin{enumerate}
%  \item Except as otherwise specified in these rules, the start point and end point of a path segment shall be rendered as specified by the meaning of the surface's current \tcode{line_cap} value (\ref{linecap}).
%  
%  \item If the end point of a path segment \textit{a} is set as the current point and is then used as the start point of another path segment, \textit{b}, the point where \tcode{a}'s end point meets \tcode{b}'s start point shall be rendered as specified by the meaning of the surface's current \tcode{line_join} value (\ref{linejoin}).
%  
%  \item ***FIXME***
%\end{enumerate}
%
%\rSec1 [paths.fillrules] {Filling paths}
%
%\pnum

\addtocounter{SectionDepthBase}{1}
\input{new-path}
\input{close-path}
\input{abs-move}
\input{rel-move}
\input{abs-line}
\input{rel-line}
\input{abs-cubic-curve}
\input{rel-cubic-curve}
\input{abs-quadratic-curve}
\input{rel-quadratic-curve}
\input{arc-clockwise}
\input{arc-counterclockwise}
\input{change-matrix}
\input{change-origin}
\input{path}
\input{path-builder}
\addtocounter{SectionDepthBase}{-1}
