%!TEX root = io2d.tex

\rSec0 [fontresourcefactory] {Class \tcode{font_resource_factory}}

\rSec1 [fontresourcefactory.synopsis] {\tcode{font_resource_factory} synopsis}

\begin{codeblock}
namespace std { namespace experimental { namespace io2d { inline namespace v1 {
  class font_resource_factory {
  public:
    // \ref{fontresourcefactory.cons}, construct/copy/move
    font_resource_factory();
    font_resource_factory(const font_resource_factory&);
    font_resource_factory& operator=(const font_resource_factory&)\;
    font_resource_factory(font_resource_factory&&) noexcept\;
    font_resource_factory& operator=(font_resource_factory&&) noexcept;
    explicit font_resource_factory(const string& family, 
      experimental::io2d::font_slant fs = 
      experimental::io2d::font_slant::normal,
      experimental::io2d::font_weight fw = 
      experimental::io2d::font_weight::normal,
      const matrix_2d& fm = matrix_2d::init_scale({ 16.0, 16.0 }),
      const experimental::io2d::font_options& fo = 
      experimental::io2d::font_options(),
      matrix_2d& sm = matrix_2d::init_identity());
    font_resource_factory(const string& family, 
      error_code& ec,
      experimental::io2d::font_slant fs = 
      experimental::io2d::font_slant::normal,
      experimental::io2d::font_weight fw = 
      experimental::io2d::font_weight::normal,
      const matrix_2d& fm = matrix_2d::init_scale({ 16.0, 16.0 }),
      const experimental::io2d::font_options& fo = 
      experimental::io2d::font_options(),
      matrix_2d& sm = matrix_2d::init_identity()) noexcept;

    // \ref{fontresourcefactory.modifiers}, modifiers
    void font_family(const string& f);
    void font_family(const string& f, error_code& ec) noexcept;
    void font_slant(const experimental::io2d::font_slant fs);
    void font_slant(const experimental::io2d::font_slant fs,
      error_code& ec) noexcept;
    void font_weight(experimental::io2d::font_weight fw);
    void font_weight(experimental::io2d::font_weight fw,
      error_code& ec) noexcept;
    void font_options(const experimental::io2d::font_options& fo) noexcept;
    void font_matrix(const matrix_2d& m) noexcept;
    void surface_matrix(const matrix_2d& m) noexcept;

    // \ref{fontresourcefactory.observers}, observers
    string font_family() const;
    string font_family(::std::error_code& ec) const noexcept;
    experimental::io2d::font_slant font_slant() const noexcept;
    experimental::io2d::font_weight font_weight() const noexcept;
    experimental::io2d::font_options font_options() const noexcept;
    matrix_2d font_matrix() const noexcept;
    matrix_2d surface_matrix() const noexcept;

  private:
    string _Family;                                 // \expos
    experimental::io2d::font_slant _Font_slant;     // \expos
    experimental::io2d::font_weight _Font_weight;   // \expos
    experimental::io2d::font_options _Font_options; // \expos
    matrix_2d _Font_matrix;                         // \expos
    matrix_2d _Surface_matrix;                      // \expos
  };
} } } }
\end{codeblock}

\rSec1 [fontresourcefactory.intro] {\tcode{font_resource_factory} Description}

\pnum
\indexlibrary{\idxcode{font_resource_factory}}
The \tcode{font_resource_factory} class is a factory class used to create \tcode{font_resource} objects.

\rSec1 [fontresourcefactory.fontmatching] {Font matching}

\pnum
The fonts that are available for use by implementations can vary depending on the execution environment, including during runtime.

\pnum
\enterexample
While a program is executing, the execution environment could execute one or more other programs that cause a font to become available or become unavailable.
\exitexample

\pnum
Once a font has been chosen by a \tcode{font_resource_factory} object or selected as the font resource of a \tcode{font_resource} object, then if the execution environment provides functionality to prevent the font from becoming unavailable, implementations shall use that functionality to prevent the font from becoming unavailable.

\pnum
If an implementation used the functionality described in the previous paragraph to prevent a font from becoming unavailable, then when there are no longer any \tcode{font_resource_factory} objects and \tcode{font_resource} objects that require the font, the implementation shall no longer prevent the font from becoming unavailable and shall make use of whatever functionality the execution environment provides, if any, to undo the effects of the functionality described in the previous paragraph that was used to prevent the font from becoming unavailable.

\pnum
If a font chosen by a \tcode{font_resource_factory} object becomes unavailable, then if a \tcode{font_resource} object is constructed using that \tcode{font_resource_factory}, the implementation shall choose an available font in the manner set forth below.

\pnum
When an implementation is required to choose a font, the implementation shall evaluate the value of the \tcode{string} object containing the name of the desired font family of the font, the value of the \tcode{font_slant} enumerator describing the desired posture of the font, and the value of the \tcode{font_weight} enumerator describing the desired weight of the font.

\pnum
If a font matching the desired font family, desired posture, and desired weight is available for use by the implementation, then that font shall be used and those desired values shall be the values of the font family, posture, and weight of the \tcode{font_resource_factory} object or \tcode{font_resource} object for which a font is being chosen.

\pnum
Otherwise, the values of the font family, posture, and weight of the \tcode{font_resource_factory} object or \tcode{font_resource} object for which a font is being chosen shall be the values of the font that the implementation selected as being the nearest match to the font specified by the desired font family, desired posture, and desired weight.

\pnum
The methodology used by an implementation to choose a nearest match to a font is \unspecnorm.

\rSec1 [fontresourcefactory.cons] {\tcode{font_resource_factory} constructors and assignment operators}

\indexlibrary{\idxcode{font_resource_factory}!constructor}
\begin{itemdecl}
explicit font_resource_factory(const string& family, 
  experimental::io2d::font_slant fs = experimental::io2d::font_slant::normal,
  experimental::io2d::font_weight fw = experimental::io2d::font_weight::normal,
  const matrix_2d& fm = matrix_2d::init_scale({ 16.0, 16.0 }),
  const experimental::io2d::font_options& fo = 
  experimental::io2d::font_options(),
  matrix_2d& sm = matrix_2d::init_identity());

font_resource_factory(const string& family, 
  error_code& ec,
  experimental::io2d::font_slant fs = experimental::io2d::font_slant::normal,
  experimental::io2d::font_weight fw = experimental::io2d::font_weight::normal,
  const matrix_2d& fm = matrix_2d::init_scale({ 16.0, 16.0 }),
  const experimental::io2d::font_options& fo = 
  experimental::io2d::font_options(),
  matrix_2d& sm = matrix_2d::init_identity()) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The implementation shall use the values of \tcode{family}, \tcode{fs}, and \tcode{fw} as the desired font family, desired posture, and desired weight, respectively, for the font matching process described in \ref{fontresourcefactory.fontmatching} and shall set the values of \tcode{_Family}, \tcode{_Font_slant}, and \tcode{_Font_weight} to the values of the font family, posture, and weight, respectively, produced by that font matching process.

\pnum
\tcode{_Font_options == fo}.

\pnum
\tcode{_Font_matrix == fm}.

\pnum
\tcode{_Surface_matrix == sm}.

\pnum
\throws
As specified in Error reporting (\ref{\iotwod.err.report}).

\pnum
\errors
\tcode{errc::not_enough_memory} if there was a failure to allocate memory.

\pnum
Other errors, if any, produced by this function are \impldef{font_resource_factory!constructor}.
\end{itemdescr}

\rSec1 [fontresourcefactory.modifiers] {\tcode{font_resource_factory} modifiers}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_family}}
\indexlibrary{\idxcode{font_family}!\idxcode{font_resource_factory}}
\begin{itemdecl}
void font_family(const string& f);
void font_family(const string& f, error_code& ec) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The implementation shall use the values of \tcode{f}, \tcode{_Font_slant}, and \tcode{_Font_weight} as the desired font family, desired posture, and desired weight, respectively, for the font matching process described in \ref{fontresourcefactory.fontmatching} and shall set the values of \tcode{_Family}, \tcode{_Font_slant}, and \tcode{_Font_weight} to the values of the font family, posture, and weight, respectively, produced by that font matching process.

\pnum
\throws
As specified in Error reporting (\ref{\iotwod.err.report}).

\pnum
\errors
\tcode{errc::not_enough_memory} if there was a failure to allocate memory.

\pnum
Other errors, if any, produced by this function are \impldef{font_resource_factory!font_family}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_slant}}
\indexlibrary{\idxcode{font_slant}!\idxcode{font_resource_factory}}
\begin{itemdecl}
void font_slant(const experimental::io2d::font_slant fs);
void font_slant(const experimental::io2d::font_slant fs, 
  error_code& ec) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The implementation shall use the values of \tcode{_Family}, \tcode{fs}, and \tcode{_Font_weight} as the desired font family, desired posture, and desired weight, respectively, for the font matching process described in \ref{fontresourcefactory.fontmatching} and shall set the values of \tcode{_Family}, \tcode{_Font_slant}, and \tcode{_Font_weight} to the values of the font family, posture, and weight, respectively, produced by that font matching process.

\pnum
\throws
As specified in Error reporting (\ref{\iotwod.err.report}).

\pnum
\errors
\tcode{errc::not_enough_memory} if there was a failure to allocate memory.

\pnum
Other errors, if any, produced by this function are \impldef{font_resource_factory!font_slant}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_weight}}
\indexlibrary{\idxcode{font_weight}!\idxcode{font_resource_factory}}
\begin{itemdecl}
void font_weight(experimental::io2d::font_weight fw);
void font_weight(experimental::io2d::font_weight fw,
  error_code& ec) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
The implementation shall use the values of \tcode{_Family}, \tcode{_Font_slant}, and \tcode{fw} as the desired font family, desired posture, and desired weight, respectively, for the font matching process described in \ref{fontresourcefactory.fontmatching} and shall set the values of \tcode{_Family}, \tcode{_Font_slant}, and \tcode{_Font_weight} to the values of the font family, posture, and weight, respectively, produced by that font matching process.

\pnum
\throws
As specified in Error reporting (\ref{\iotwod.err.report}).

\pnum
\errors
\tcode{errc::not_enough_memory} if there was a failure to allocate memory.

\pnum
Other errors, if any, produced by this function are \impldef{font_resource_factory!font_weight}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_options}}
\indexlibrary{\idxcode{font_options}!\idxcode{font_resource_factory}}
\begin{itemdecl}
void font_options(const experimental::io2d::font_options& fo) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{_Font_options == fo}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_matrix}}
\indexlibrary{\idxcode{font_matrix}!\idxcode{font_resource_factory}}
\begin{itemdecl}
void font_matrix(const matrix_2d& m) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{_Font_matrix == m}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{surface_matrix}}
\indexlibrary{\idxcode{surface_matrix}!\idxcode{font_resource_factory}}
\begin{itemdecl}
void surface_matrix(const matrix_2d& m) noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\effects
\tcode{_Surface_matrix == m}.
\end{itemdescr}

\rSec1 [fontresourcefactory.observers] {\tcode{font_resource_factory} observers}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_family}}
\indexlibrary{\idxcode{font_family}!\idxcode{font_resource_factory}}
\begin{itemdecl}
string font_family() const;
string font_family(::std::error_code& ec) const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{_Family}.

\throws
As specified in Error reporting (\ref{\iotwod.err.report}).

\pnum
\errors
\tcode{errc::not_enough_memory} if there was a failure to allocate memory.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_slant}}
\indexlibrary{\idxcode{font_slant}!\idxcode{font_resource_factory}}
\begin{itemdecl}
experimental::io2d::font_slant font_slant() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{_Font_slant}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_weight}}
\indexlibrary{\idxcode{font_weight}!\idxcode{font_resource_factory}}
\begin{itemdecl}
experimental::io2d::font_weight font_weight() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{_Font_weight}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_options}}
\indexlibrary{\idxcode{font_options}!\idxcode{font_resource_factory}}
\begin{itemdecl}
experimental::io2d::font_options font_options() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{_Font_options}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{font_matrix}}
\indexlibrary{\idxcode{font_matrix}!\idxcode{font_resource_factory}}
\begin{itemdecl}
matrix_2d font_matrix() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{_Font_matrix}.
\end{itemdescr}

\indexlibrary{\idxcode{font_resource_factory}!\idxcode{surface_matrix}}
\indexlibrary{\idxcode{surface_matrix}!\idxcode{font_resource_factory}}
\begin{itemdecl}
matrix_2d surface_matrix() const noexcept;
\end{itemdecl}
\begin{itemdescr}
\pnum
\returns
\tcode{_Surface_matrix}.
\end{itemdescr}
